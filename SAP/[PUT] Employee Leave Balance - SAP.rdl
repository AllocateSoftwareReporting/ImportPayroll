<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Tablix Name="Tablix1">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.6cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox1">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>record key</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox1</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox3">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>record no</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox3</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox5">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>emp no</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox5</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox7">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>leave type</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox7</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox9">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>day date</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox9</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox11">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>entitlement</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox11</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox13">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>pro rata</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox13</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox15">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>pro rata taken</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox15</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox17">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>anniversary date</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox17</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <TablixRow>
              <Height>0.6cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="record_key">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!record_key.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>record_key</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="record_no">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!record_no.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>record_no</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="emp_no">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!emp_no.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>emp_no</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="leave_type">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!leave_type.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>leave_type</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="day_date">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!day_date.Value</Value>
                              <Style>
                                <Format>dd/MM/yyyy</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>day_date</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="entitlement">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!entitlement.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>entitlement</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="pro_rata">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!pro_rata.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>pro_rata</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="pro_rata_taken">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!pro_rata_taken.Value</Value>
                              <Style />
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>pro_rata_taken</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="anniversary_date">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!anniversary_date.Value</Value>
                              <Style>
                                <Format>dd/MM/yyyy</Format>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>anniversary_date</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember />
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Visibility>
                <Hidden>true</Hidden>
              </Visibility>
              <KeepWithGroup>After</KeepWithGroup>
            </TablixMember>
            <TablixMember>
              <Group Name="Details" />
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <DataSetName>DataSet1</DataSetName>
        <Height>1.2cm</Height>
        <Width>22.5cm</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>0.47244in</Height>
    <Style />
  </Body>
  <Width>8.85827in</Width>
  <Page>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>21cm</PageWidth>
    <LeftMargin>2cm</LeftMargin>
    <RightMargin>2cm</RightMargin>
    <TopMargin>2cm</TopMargin>
    <BottomMargin>2cm</BottomMargin>
    <ColumnSpacing>0.13cm</ColumnSpacing>
    <Style />
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource1">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString>Data Source=MEL-DNF162S;Initial Catalog=NorthenHealth</ConnectString>
      </ConnectionProperties>
      <rd:SecurityType>DataBase</rd:SecurityType>
      <rd:DataSourceID>41ca208b-363d-4470-ac8c-73350a846119</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet1">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>SELECT 'import_EMPBA' AS record_key,
'1' AS record_no,
CASE WHEN ISNUMERIC(lve.Column01) = 1 THEN CAST(CAST(lve.Column01 AS decimal(20)) AS varchar(150)) 
ELSE SUBSTRING(lve.Column01,PATINDEX('%[^0]%',lve.Column01),150) 
END AS emp_no,
CASE WHEN lve.Column02 = '10' THEN '0100'
WHEN lve.Column02 = '12' THEN '0120'
WHEN lve.Column02 = '22' THEN '0203'
WHEN lve.Column02 = '24' THEN '0205'
WHEN lve.Column02 = '25' THEN '0200'
WHEN lve.Column02 = '26' THEN '0203'
WHEN lve.Column02 = '50' THEN '0501'
WHEN lve.Column02 = '51' THEN '0500'
WHEN lve.Column02 = '57' THEN '0685'
WHEN lve.Column02 = '73' THEN '0602'
WHEN lve.Column02 = '74' THEN '0650'
WHEN lve.Column02 = '75' THEN '0634'
WHEN lve.Column02 = '76' THEN '0662'
WHEN lve.Column02 = '77' THEN '0315'
WHEN lve.Column02 = '78' THEN '0661'
WHEN lve.Column02 = '79' THEN '0675'
WHEN lve.Column02 = '80' THEN '0676'
WHEN lve.Column02 = '81' THEN '0677'
WHEN lve.Column02 = '82' THEN '0678'
ELSE lve.Column02
END AS leave_type,
dbo.check_valid_date(lve.Column03,'N') AS day_date,
lve.Column05 AS entitlement,
lve.Column04 AS pro_rata,
lve.Column06 AS pro_rata_taken,
dbo.check_valid_date(CASE WHEN lve.Column07 LIKE '00/00/%' THEN '01/01/1900' ELSE lve.Column07 END,'N') AS anniversary_date
FROM gi_ROSTERONLVE lve LEFT OUTER JOIN shift s ON s.payroll_ref IN(CASE WHEN lve.Column02 = '10' THEN '0100'
WHEN lve.Column02 = '12' THEN '0120'
WHEN lve.Column02 = '22' THEN '0203'
WHEN lve.Column02 = '24' THEN '0205'
WHEN lve.Column02 = '25' THEN '0200'
WHEN lve.Column02 = '26' THEN '0203'
WHEN lve.Column02 = '50' THEN '0501'
WHEN lve.Column02 = '51' THEN '0500'
WHEN lve.Column02 = '57' THEN '0685'
WHEN lve.Column02 = '73' THEN '0602'
WHEN lve.Column02 = '74' THEN '0650'
WHEN lve.Column02 = '75' THEN '0634'
WHEN lve.Column02 = '76' THEN '0662'
WHEN lve.Column02 = '77' THEN '0315'
WHEN lve.Column02 = '78' THEN '0661'
WHEN lve.Column02 = '79' THEN '0675'
WHEN lve.Column02 = '80' THEN '0676'
WHEN lve.Column02 = '81' THEN '0677'
WHEN lve.Column02 = '82' THEN '0678'
END)
LEFT OUTER JOIN leave_attribute la ON (la.shift_id = s.shift_id AND la.leave_attribute_type_id = 17)
LEFT OUTER JOIN leave_attribute_type lat ON (lat.leave_attribute_type_id = la.leave_attribute_type_id 
AND lat.leave_attribute_type_code = 'IMPEXCL')
WHERE lve.Column02 IN ('10','12','22','24','25','26','50','51','57','73','74','75','76','77',
'78','79','80','81','82')
AND s.payroll_ref IN ('0100','0120','0203','0205','0200','0203','0501','0500','0685','0602',
'0650','0634','0662','0315','0661','0675','0676','0677','0678')
AND (lat.leave_attribute_type_code IS NULL OR (lat.leave_attribute_type_code IS NOT NULL AND la.value = 'N'))
UNION ALL
SELECT 'import_EMPBA' AS record_key,
'1' AS record_no,
CASE WHEN ISNUMERIC(lve.Column01) = 1 THEN CAST(CAST(lve.Column01 AS decimal(20)) AS varchar(150)) 
ELSE SUBSTRING(lve.Column01,PATINDEX('%[^0]%',lve.Column01),150) 
END AS emp_no,
'0400' AS leave_type,
dbo.check_valid_date(lve.Column03,'N') AS day_date,
SUM(CASE WHEN ISNUMERIC(lve.Column05) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column05 AS numeric(30,5)) END) AS entitlement,
SUM(CASE WHEN ISNUMERIC(lve.Column04) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column04 AS numeric(30,5)) END) AS pro_rata,
SUM(CASE WHEN ISNUMERIC(lve.Column06) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column06 AS numeric(30,5)) END) AS pro_rata_taken,
MAX(dbo.check_valid_date(CASE WHEN lve.Column07 LIKE '00/00/%' THEN '01/01/1900' ELSE lve.Column07 END,'N')) AS anniversary_date
FROM gi_ROSTERONLVE lve LEFT OUTER JOIN shift s ON s.payroll_ref IN(CASE WHEN lve.Column02 = '40' THEN '0400'
WHEN lve.Column02 = '41' THEN '0400'
WHEN lve.Column02 = '42' THEN '0400'
END)
LEFT OUTER JOIN leave_attribute la ON (la.shift_id = s.shift_id AND la.leave_attribute_type_id = 17)
LEFT OUTER JOIN leave_attribute_type lat ON (lat.leave_attribute_type_id = la.leave_attribute_type_id 
AND lat.leave_attribute_type_code = 'IMPEXCL')
WHERE lve.Column02 IN ('40','41','42')
AND s.payroll_ref = '0400'
AND (lat.leave_attribute_type_code IS NULL OR (lat.leave_attribute_type_code IS NOT NULL AND la.value = 'N'))
GROUP BY lve.Column01,
dbo.check_valid_date(lve.Column03,'N')
UNION ALL
SELECT 'import_EMPBA' AS record_key,
'1' AS record_no,
CASE WHEN ISNUMERIC(lve.Column01) = 1 THEN CAST(CAST(lve.Column01 AS decimal(20)) AS varchar(150)) 
ELSE SUBSTRING(lve.Column01,PATINDEX('%[^0]%',lve.Column01),150) 
END AS emp_no,
'0206' AS leave_type,
dbo.check_valid_date(lve.Column03,'N') AS day_date,
SUM(CASE WHEN ISNUMERIC(lve.Column05) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column05 AS numeric(30,5)) END) AS entitlement,
SUM(CASE WHEN ISNUMERIC(lve.Column04) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column04 AS numeric(30,5)) END) AS pro_rata,
SUM(CASE WHEN ISNUMERIC(lve.Column06) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column06 AS numeric(30,5)) END) AS pro_rata_taken,
MAX(dbo.check_valid_date(CASE WHEN lve.Column07 LIKE '00/00/%' THEN '01/01/1900' ELSE lve.Column07 END,'N')) AS anniversary_date
FROM gi_ROSTERONLVE lve LEFT OUTER JOIN shift s ON s.payroll_ref IN(CASE WHEN lve.Column02 = '23' THEN '0206'
WHEN lve.Column02 = '72' THEN '0206'
END)
LEFT OUTER JOIN leave_attribute la ON (la.shift_id = s.shift_id AND la.leave_attribute_type_id = 17)
LEFT OUTER JOIN leave_attribute_type lat ON (lat.leave_attribute_type_id = la.leave_attribute_type_id 
AND lat.leave_attribute_type_code = 'IMPEXCL')
WHERE lve.Column02 IN ('23','72')
AND s.payroll_ref = '0206'
AND (lat.leave_attribute_type_code IS NULL OR (lat.leave_attribute_type_code IS NOT NULL AND la.value = 'N'))
GROUP BY lve.Column01,
dbo.check_valid_date(lve.Column03,'N')
UNION ALL
SELECT 'import_EMPBA' AS record_key,
'1' AS record_no,
CASE WHEN ISNUMERIC(lve.Column01) = 1 THEN CAST(CAST(lve.Column01 AS decimal(20)) AS varchar(150)) 
ELSE SUBSTRING(lve.Column01,PATINDEX('%[^0]%',lve.Column01),150) 
END AS emp_no,
'0607' AS leave_type,
dbo.check_valid_date(lve.Column03,'N') AS day_date,
SUM(CASE WHEN ISNUMERIC(lve.Column05) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column05 AS numeric(30,5)) END) AS entitlement,
SUM(CASE WHEN ISNUMERIC(lve.Column04) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column04 AS numeric(30,5)) END) AS pro_rata,
SUM(CASE WHEN ISNUMERIC(lve.Column06) &lt;&gt; 1 THEN 0 ELSE CAST(lve.Column06 AS numeric(30,5)) END) AS pro_rata_taken,
MAX(dbo.check_valid_date(CASE WHEN lve.Column07 LIKE '00/00/%' THEN '01/01/1900' ELSE lve.Column07 END,'N')) AS anniversary_date
FROM gi_ROSTERONLVE lve LEFT OUTER JOIN shift s ON s.payroll_ref IN(CASE WHEN lve.Column02 = '62' THEN '0607'
WHEN lve.Column02 = '69' THEN '0607'
END)
LEFT OUTER JOIN leave_attribute la ON (la.shift_id = s.shift_id AND la.leave_attribute_type_id = 17)
LEFT OUTER JOIN leave_attribute_type lat ON (lat.leave_attribute_type_id = la.leave_attribute_type_id 
AND lat.leave_attribute_type_code = 'IMPEXCL')
WHERE lve.Column02 IN ('62','69')
AND s.payroll_ref = '0607'
AND (lat.leave_attribute_type_code IS NULL OR (lat.leave_attribute_type_code IS NOT NULL AND la.value = 'N'))
GROUP BY lve.Column01,
dbo.check_valid_date(lve.Column03,'N')</CommandText>
      </Query>
      <Fields>
        <Field Name="record_key">
          <DataField>record_key</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="record_no">
          <DataField>record_no</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="emp_no">
          <DataField>emp_no</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="leave_type">
          <DataField>leave_type</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="day_date">
          <DataField>day_date</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="entitlement">
          <DataField>entitlement</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="pro_rata">
          <DataField>pro_rata</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="pro_rata_taken">
          <DataField>pro_rata_taken</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="anniversary_date">
          <DataField>anniversary_date</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>8b645a93-c0cb-4fc7-8f41-62475e299507</rd:ReportID>
</Report>